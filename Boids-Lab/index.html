<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Boids Simulation - Interactive Mini-Lab</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Boids Simulation</h1>
      <p class="subtitle">Emergent Flocking Behavior from Simple Rules</p>
    </header>

    <main>
      <div class="canvas-container">
        <canvas id="simulation"></canvas>
        <div class="canvas-hint">Click to add obstacles | Right-click to remove</div>
      </div>

      <aside class="controls-panel">
        <!-- Parameters Section -->
        <section class="control-group">
          <h3>Parameters</h3>

          <div class="slider-control" title="Avoid crowding - higher values = more personal space">
            <label>
              Separation: <span id="separationValue">1.5</span>
            </label>
            <input type="range" id="separation" min="0" max="3" step="0.1" value="1.5">
          </div>

          <div class="slider-control" title="Match neighbors' direction - higher values = coordinated movement">
            <label>
              Alignment: <span id="alignmentValue">1.0</span>
            </label>
            <input type="range" id="alignment" min="0" max="2" step="0.1" value="1.0">
          </div>

          <div class="slider-control" title="Move toward group center - higher values = tighter flocks">
            <label>
              Cohesion: <span id="cohesionValue">1.0</span>
            </label>
            <input type="range" id="cohesion" min="0" max="2" step="0.1" value="1.0">
          </div>

          <div class="slider-control" title="How far boids can see neighbors - affects flock size">
            <label>
              Neighbor Radius: <span id="neighborRadiusValue">50</span>
            </label>
            <input type="range" id="neighborRadius" min="20" max="150" step="5" value="50">
          </div>

          <div class="slider-control" title="Speed limit for all boids - affects overall energy">
            <label>
              Max Speed: <span id="maxSpeedValue">4.0</span>
            </label>
            <input type="range" id="maxSpeed" min="1" max="8" step="0.5" value="4.0">
          </div>
        </section>

        <!-- Presets Section -->
        <section class="control-group">
          <h3>Presets</h3>
          <div class="button-row">
            <button id="schoolingBtn" class="preset-btn" title="Organized, flowing movement like fish schools">Schooling</button>
            <button id="chaoticBtn" class="preset-btn" title="Disorganized, erratic movement">Chaotic</button>
            <button id="clusterBtn" class="preset-btn" title="Dense, cohesive group">Tight Cluster</button>
          </div>
        </section>

        <!-- Visuals Section -->
        <section class="control-group">
          <h3>Visuals</h3>

          <div class="checkbox-control">
            <label>
              <input type="checkbox" id="colorBySpeed" checked>
              Color by Speed
            </label>
          </div>

          <div class="checkbox-control">
            <label>
              <input type="checkbox" id="showTrails">
              Motion Trails
            </label>
          </div>

          <div class="checkbox-control">
            <label>
              <input type="checkbox" id="showHeatmap">
              Density Heatmap
            </label>
          </div>

          <div class="slider-control heatmap-intensity">
            <label>
              Heatmap Intensity: <span id="heatmapIntensityValue">0.7</span>
            </label>
            <input type="range" id="heatmapIntensity" min="0.1" max="1" step="0.1" value="0.7">
          </div>

          <button id="themeBtn" class="control-btn full-width theme-neon" title="Cycle through visual themes">Theme: Neon</button>
        </section>

        <!-- Interaction Section -->
        <section class="control-group">
          <h3>Interaction</h3>
          <button id="mouseModeBtn" class="control-btn full-width mouse-off" title="Toggle mouse attraction/repulsion">Mouse: Off</button>
          <button id="clearObstaclesBtn" class="control-btn full-width" title="Remove all obstacles from the simulation">Clear Obstacles</button>
        </section>

        <!-- Stats Section -->
        <section class="control-group stats-group">
          <h3>Stats</h3>
          <div class="stats-grid">
            <div class="stat">
              <span class="stat-label">FPS:</span>
              <span id="fps" class="stat-value">0</span>
            </div>
            <div class="stat">
              <span class="stat-label">Boids:</span>
              <span id="boidCount" class="stat-value">150</span>
            </div>
            <div class="stat">
              <span class="stat-label">Avg Speed:</span>
              <span id="avgSpeed" class="stat-value">0.00</span>
            </div>
            <div class="stat">
              <span class="stat-label">Avg Neighbors:</span>
              <span id="avgNeighbors" class="stat-value">0.0</span>
            </div>
          </div>
        </section>

        <!-- Controls Section -->
        <section class="control-group">
          <h3>Controls</h3>
          <div class="button-row">
            <button id="resetBtn" class="control-btn">Reset</button>
            <button id="pauseBtn" class="control-btn">Pause</button>
          </div>
          <button id="boundaryBtn" class="control-btn full-width">Boundary: Wrap</button>
        </section>

        <!-- Info Panel -->
        <section class="control-group info-group">
          <button id="infoToggle" class="info-toggle">Show Info ▼</button>
          <div id="infoContent" class="info-content collapsed">
            <h4>How This Relates to AI</h4>
            <p>
              Just like these boids create complex flocking behavior from simple rules,
              Large Language Models (LLMs) generate coherent text from simple neural network operations:
            </p>
            <ul>
              <li>
                <strong>Local → Global:</strong> Each boid follows basic rules locally; together they create
                emergent patterns. Each neuron in an LLM does simple math; together they "understand" language.
              </li>
              <li>
                <strong>Parameter Tuning:</strong> Adjusting separation/alignment weights changes flock behavior.
                Adjusting temperature/top-p in LLMs changes text creativity and coherence.
              </li>
              <li>
                <strong>No Central Control:</strong> No single boid leads the flock. No single neuron "knows"
                what the LLM is doing—intelligence emerges from their coordination.
              </li>
            </ul>
            <p class="info-footer">
              Experiment with the sliders and watch how small parameter changes create big behavioral shifts—just like prompting an LLM!
            </p>
          </div>
        </section>
      </aside>
    </main>
  </div>

  <script type="module">
    import { Simulation } from './js/simulation.js?v=2';
    import { Controls } from './js/controls.js?v=2';

    // Initialize simulation
    const canvas = document.getElementById('simulation');
    const simulation = new Simulation(canvas);

    // Initialize controls
    const controls = new Controls(simulation);

    // Start the simulation
    simulation.start();
  </script>
</body>
</html>
